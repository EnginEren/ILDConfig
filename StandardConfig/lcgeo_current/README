###################################################
#
# HOWTO run lcgeo and Marlin examples
# with standard configuration
# 
# F.Gaede, DESY/CERN
#   06/2015  F.G:  updated to use lcgeo/ddsim
#   12/2011: F.G.: updated to new ILD_01_dev model 
#   06/2012: J.E.: updated to new ILD_o{1,2,3}_v01 models
###################################################

#  These little examples server as an ultra quick introduction on 
#  how to run ilcsoft programs and as a mini-test after installation
#  of a new (complete) ilcsoft release.
#

# 1. ----  initialize the current ilcsoft release, e.g.  ------

  source /afs/desy.de/project/ilcsoft/sw/x86_64_gcc44_sl6/v01-17-07/init_ilcsoft.sh

# 2. ---- run the lcgeo/ddsim simulation example  ------

    python ddsim.py $lcgeo_DIR/ILD/compact/ILD_o1_v05/ILD_o1_v05.xml

    ( modify ddsim.py as needed for other inputfiles/simulations
     the original can be found at $lcgeo_DIR/example/ddsim.py )

#--   this creates the file:    bbudsc_3evt.slcio

  #- example: examine the collections in the file:

  anajob bbudsc_3evt.slcio

  
 
# 3. ----- create a gear file for the model ----------------

  convertToGear default $lcgeo_DIR/ILD/compact/ILD_o1_v05/ILD_o1_v05.xml gear_ILD_o1_v05_dd4hep.xml

  This creates a gear file for the ILD model. 


# 4. ----  reconstruct these events:  ------

  Marlin bbudsc_3evt_stdreco.xml


#-- creates:   bbudsc_3evt_REC.slcio 
#   and        bbudsc_3evt_DST.slcio

#- example: dump the details of the 2nd event in the DST file: 

   dumpevent bbudsc_3evt_DST.slcio 2 | less

# 3.1 ---- alternative reconstrunction steering files: ------
# -- they substitute std silicon tracking with new algorithms --
# -- Attention! still experimental --

  Marlin FPCCDTracker_stdreco.xml
# -- Adding Marlin steering file which runs the FPCCD tracking algorithm --
# -- Experimental - not yet fully validated --

  Marlin minivector_reco.xml
# -- Adding a reconstruction file which uses a mini-vector algorithm, based on cellular automaton tools, --
# -- for pattern recognition at the VXD-SIT --
# -- still experimental - not fully validated --
# -- According to the examined VXD design, the user should set the proper time resolution for pair bkg overlay --
# -- and correct accordingly for spatial resolution at the VXDPlanarDigiProcessor --
   



3.2 reconstruct with using 'new' reconstruction based on DDRec

Marlin bbudsc_3evt_stdreco_dd4hep.xml --InitDD4hep.DD4hepXMLFile=$lcgeo_DIR/ILD/compact/ILD_o1_v05/ILD_o1_v05.xml



# 4. ---- view the result in the event display
 
# a) 

#--- start the event display (server) first: 
  
   glced &


#--- view rec or DST events:

   Marlin bbudsc_3evt_viewer.xml

   Marlin bbudsc_3evt_viewerDST.xml

 
# b)  (new in v01-10) 
  
# or start both, glced and Marlin in one go:

 ced2go   -d GearOutput.xml  bbudsc_3evt_REC.slcio

